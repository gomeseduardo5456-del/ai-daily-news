<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI æ–°é—»é€Ÿé€’ - è‡ªåŠ¨åŒ–çœ‹æ¿</title>
    <style>
        :root { --primary: #007AFF; --bg: #F2F2F7; --card: #FFFFFF; --text: #1C1C1E; --sub: #8E8E93; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 16px; line-height: 1.5; }
        .header { margin: 10px 0 25px; }
        h1 { font-size: 24px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .filter-bar { background: var(--card); padding: 12px; border-radius: 12px; display: flex; align-items: center; gap: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        select { border: 1px solid #DDD; padding: 8px 12px; border-radius: 8px; font-size: 15px; flex-grow: 1; outline: none; background: #FFF; }
        .region-tag { display: inline-block; background: var(--primary); color: white; padding: 4px 12px; border-radius: 20px; font-size: 13px; font-weight: bold; margin: 24px 0 12px; }
        .news-card { background: var(--card); border-radius: 16px; padding: 16px; margin-bottom: 12px; display: block; text-decoration: none; color: inherit; box-shadow: 0 2px 6px rgba(0,0,0,0.04); transition: transform 0.1s; }
        .news-card:active { transform: scale(0.98); background: #FAFAFA; }
        .news-topic { font-size: 12px; color: var(--primary); font-weight: 600; margin-bottom: 4px; display: block; }
        .news-title { font-size: 17px; font-weight: 700; margin-bottom: 6px; display: block; line-height: 1.4; }
        .news-summary { font-size: 14px; color: #444; margin: 0; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; }
        .loading { text-align: center; margin-top: 60px; color: var(--sub); font-size: 15px; }
    </style>
</head>
<body>

<div class="header">
    <h1>ğŸ“¢ AI æ–°é—»é€Ÿé€’</h1>
    <div class="filter-bar">
        <span>é€‰æ‹©æ—¥æœŸï¼š</span>
        <select id="datePicker" onchange="displayNews()">
            <option value="">æ­£åœ¨åŒæ­¥è¡¨æ ¼...</option>
        </select>
    </div>
</div>

<div id="content">
    <div class="loading">æ­£åœ¨ä»æ‚¨çš„ Google Sheets è·å–æœ€æ–°æ•°æ®...</div>
</div>

<script>
    // å·²æ ¹æ®ä½ æä¾›çš„é“¾æ¥è‡ªåŠ¨å¡«å†™ ID 
    const SHEET_ID = '1UOGd4bEB0K_MNXFrJUA5Y5MPe0GS3mR6HV1OFrJIYC0'; 
    const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;

    let allNews = [];

    async function fetchNews() {
        try {
            const response = await fetch(SHEET_URL);
            const data = await response.text();
            
            // è§£æ CSVï¼šè·³è¿‡ç¬¬ä¸€è¡Œè¡¨å¤´ 
            const rows = data.split('\n').slice(1); 
            allNews = rows.map(row => {
                // è‡ªåŠ¨å¤„ç† CSV é‡Œçš„åŒå¼•å·å’Œé€—å·
                const cols = row.split('","').map(c => c.replace(/"/g, '').trim());
                return {
                    date: cols[0],      // æ—¥æœŸ
                    region: cols[1],    // å›½å†…/æµ·å¤–
                    topic: cols[2],     // è¯é¢˜
                    company: cols[3],   // å…¬å¸
                    title: cols[4],     // æ ‡é¢˜
                    summary: cols[5],   // æ ¸å¿ƒå†…å®¹
                    source: cols[6],    // æ¥æº
                    link: cols[7]       // é“¾æ¥
                };
            }).filter(item => item.date && item.title); // è¿‡æ»¤ç©ºè¡Œ

            initDatePicker();
        } catch (error) {
            document.getElementById('content').innerHTML = 
                '<div class="loading">âŒ åŠ è½½å¤±è´¥ï¼Œè¯·ç¡®ä¿è¡¨æ ¼å·²â€œå‘å¸ƒåˆ°ç½‘ç»œâ€</div>';
        }
    }

    function initDatePicker() {
        const picker = document.getElementById('datePicker');
        // è·å–æ‰€æœ‰å”¯ä¸€æ—¥æœŸå¹¶é™åºæ’åˆ—
        const uniqueDates = [...new Set(allNews.map(n => n.date))].sort().reverse();
        
        picker.innerHTML = uniqueDates.map(d => `<option value="${d}">${d}</option>`).join('');
        displayNews();
    }

    function displayNews() {
        const selectedDate = document.getElementById('datePicker').value;
        const container = document.getElementById('content');
        const filtered = allNews.filter(n => n.date === selectedDate);

        let html = '';
        const regions = ["æµ·å†…", "æµ·å¤–"];

        regions.forEach(reg => {
            const regNews = filtered.filter(n => n.region === reg);
            if (regNews.length > 0) {
                html += `<div class="region-tag">â­•ï¸ ${reg}</div>`;
                regNews.forEach(n => {
                    html += `
                        <a href="${n.link}" class="news-card" target="_blank">
                            <span class="news-topic">ã€${n.topic}ã€‘ Â· ${n.company}</span>
                            <span class="news-title">${n.title}</span>
                            <p class="news-summary">${n.summary}</p>
                        </a>
                    `;
                });
            }
        });

        container.innerHTML = html || '<div class="loading">è¯¥æ—¥æœŸæš‚æ— æ–°é—»æ›´æ–°</div>';
    }

    fetchNews();
</script>

</body>
</html>